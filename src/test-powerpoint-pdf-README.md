# PowerPoint PDF テキスト抽出改善のテストデモ

## 概要

このテストファイルは、PowerPoint から PDF 化された資料のテキスト読み込み精度向上機能のデモンストレーションです。

## テスト内容

### 従来の方法 vs 改善された方法の比較

#### 従来の方法（シンプル結合）
```
2024年度決算説明会 業績ハイライト 売上高 1,000億円 (前年比+15%) 売上高 営業利益 150億円 (前年比+25%) 主要な成果 1. 新製品の売上寄与が好調 2. 海外展開の加速 3. コスト削減効果 今後の展望 デジタル変革の推進により、 さらなる成長を目指します 株主還元 配当性向30%を目標 2025年度 売上目標 1,200億円
```

#### 改善された方法（座標ベースソート + 重複除去）
```
2024年度決算説明会
業績ハイライト
売上高 営業利益
1,000億円 150億円
(前年比+15%) (前年比+25%)
主要な成果
1. 新製品の売上寄与が好調
2. 海外展開の加速
3. コスト削減効果
今後の展望 株主還元
デジタル変革の推進により、 配当性向30%を目標
さらなる成長を目指します
2025年度 売上目標 1,200億円
```

## 改善点

### 1. 読みやすさの向上
- 適切な改行によりレイアウトが復元された
- 関連する項目が適切にグループ化された
- 論理的な読み順になった

### 2. 重複テキストの除去
- PowerPoint特有の重複テキスト（"売上高"の重複）が除去された
- テキスト長が178文字から174文字に最適化された

### 3. デバッグ情報の充実
- 各テキストアイテムの座標とサイズ情報が表示
- 重複除去プロセスが可視化
- 処理結果の統計情報が出力

## 実行方法

### ブラウザでの実行
1. ブラウザの開発者ツールを開く
2. コンソールタブを選択
3. `runPowerPointPDFTest()` を実行

### Node.js での実行
```bash
cd src
node test-powerpoint-pdf.js
```

## 期待される効果

### 株主対話における品質向上
- PowerPoint決算資料からの正確なテキスト抽出
- 構造化された情報による適切なコンテキスト理解
- Azure OpenAI への明確な情報提供

### 開発・デバッグの効率化
- 詳細なログによる問題特定の迅速化
- 抽出プロセスの透明性向上
- テキスト内容の完全な可視化

## 技術的詳細

### 座標ベースソート
- Y座標による上下関係の把握
- X座標による左右関係の把握
- 5px以内の誤差を同一行とみなす

### 重複除去アルゴリズム
- 完全一致テキストの検出
- 部分一致（包含関係）の検出
- 位置ベースの重複判定

### エラーハンドリング
- 座標情報なしの場合のフォールバック
- 例外発生時のシンプル抽出への切り替え
- 処理継続による堅牢性確保

---

**作成日**: 2025年7月31日  
**目的**: PowerPoint PDF読み込み精度向上のデモンストレーション  
**対象**: 開発者、テスター、品質保証