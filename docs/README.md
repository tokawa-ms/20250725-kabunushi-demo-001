# 株主対話デモアプリケーション

## 概要

このアプリケーションは、株主と取締役の間での対話をシミュレートするWebアプリケーションです。Azure OpenAI GPT-4.1-miniを使用して、PDFファイルの内容を基にした自然な対話を生成します。

## 主な機能

### 1. PDF資料管理
- **ファイルアップロード**: 決算短信、株主総会資料などのPDFファイルをアップロード
- **プレビュー表示**: アップロードしたPDFファイルのページ単位でのプレビュー
- **ページナビゲーション**: PDFのページ送り・戻し機能
- **テキスト抽出**: PDF.jsを使用したテキストコンテンツの抽出

### 2. Azure OpenAI 連携
- **接続設定**: エンドポイント、APIキー、デプロイメント名、APIバージョンの設定
- **接続テスト**: 設定した情報でのAzure OpenAIへの接続確認
- **設定保存**: ローカルストレージへの設定情報の永続化
- **環境変数対応**: 以下の環境変数からの設定読み込み
  - `AZURE_OPENAI_ENDPOINT`
  - `AZURE_OPENAI_API_KEY`
  - `AZURE_OPENAI_DEPLOYMENT_NAME`
  - `AZURE_OPENAI_API_VERSION`

### 3. 対話シミュレーション
- **自動質問生成**: 株主の立場からの質問を自動生成
- **取締役回答生成**: 取締役の立場からの回答を自動生成
- **5ターン対話**: 株主と取締役が交互に5回やり取り
- **対話要約**: 5ターン終了後の対話内容の自動要約
- **リアルタイム表示**: 対話内容のリアルタイム更新

### 4. UI/UX機能
- **レスポンシブデザイン**: モバイル、タブレット、デスクトップ対応
- **色分け表示**: 株主（青）、取締役（緑）、システム（紫）の吹き出し
- **アイコン表示**: 発言者を識別するためのアイコン
- **マークダウン対応**: 吹き出し内でのマークダウン記法サポート
- **アニメーション**: フェードイン、スライドインなどの視覚効果

## 技術仕様

### フロントエンド技術
- **HTML5**: UTF-8エンコーディング、セマンティックマークアップ
- **CSS3**: TailwindCSS (CDN) + カスタムCSS
- **JavaScript**: ES6準拠、モジュラー設計
- **PDF.js**: PDFファイル処理ライブラリ (CDN)

### APIとサービス
- **Azure OpenAI**: GPT-4.1-miniモデルによる対話生成
- **REST API**: Azure OpenAI Chat Completions API
- **ローカルストレージ**: ブラウザでの設定保存

### アーキテクチャ
- **クライアントサイドのみ**: バックエンド不要
- **シングルページアプリケーション**: 単一HTMLファイル
- **イベント駆動**: ユーザーインタラクションに基づく処理
- **状態管理**: JavaScriptクラスによる状態の一元管理

## ファイル構成

```
src/
├── index.html          # メインアプリケーション
├── css/
│   └── styles.css      # カスタムスタイル
└── js/
    └── script.js       # メインアプリケーションロジック
```

## 使用方法

### 1. 初期設定
1. `src/index.html`をブラウザで開く
2. Azure OpenAI接続設定を入力
   - エンドポイント URL
   - API キー
   - デプロイメント名
   - API バージョン
3. 「接続テスト」ボタンで接続を確認
4. 「設定保存」ボタンで設定を保存

### 2. PDF資料の準備
1. 「PDF資料アップロード」セクションでPDFファイルを選択
2. アップロードされたファイルが一覧に表示される
3. 「プレビュー」ボタンでPDFの内容を確認

### 3. 対話の実行
1. 「対話開始」ボタンをクリック
2. 株主からの質問が自動生成される
3. 取締役からの回答が自動生成される
4. 5ターンの対話が自動的に進行
5. 最後に対話の要約が表示される

## ログ出力

アプリケーションは詳細なコンソールログを出力します：

- **初期化**: アプリケーション開始とDOM要素の初期化
- **設定管理**: 設定の読み込み、保存、検証
- **API通信**: Azure OpenAIへのリクエストとレスポンス
- **PDF処理**: ファイルアップロード、解析、レンダリング
- **対話生成**: 質問生成、回答生成、要約生成
- **エラー処理**: 各種エラーの詳細情報

## エラーハンドリング

- **接続エラー**: Azure OpenAI接続失敗時の詳細メッセージ
- **PDFエラー**: PDFファイル処理失敗時の適切な通知
- **APIエラー**: API呼び出し失敗時のレスポンス詳細
- **設定エラー**: 必須項目未入力時の警告メッセージ

## セキュリティ考慮事項

- **APIキー管理**: ブラウザローカルストレージでの安全な保存
- **HTTPS通信**: Azure OpenAI APIとの暗号化通信
- **入力検証**: ユーザー入力の適切なバリデーション
- **エラー情報**: センシティブ情報を含まないエラーメッセージ

## パフォーマンス最適化

- **コンテキスト管理**: LLMコンテキスト長の適切な制限
- **トークン最適化**: MaxTokensの適切な設定
- **レスポンシブローディング**: 処理中のローディング表示
- **メモリ管理**: PDF処理時のメモリ使用量の最適化

## ブラウザ対応

- **Chrome**: 90以上
- **Firefox**: 88以上
- **Safari**: 14以上
- **Edge**: 90以上

## 今後の拡張可能性

- **多言語対応**: 国際化機能の追加
- **音声入力**: 音声による質問入力
- **データ分析**: 対話内容の分析機能
- **テンプレート**: 業界別の質問テンプレート
- **エクスポート**: 対話結果のPDF出力